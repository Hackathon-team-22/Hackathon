## Отчет о тестировании приложения "Финансовый мониторинг"

Данный отчет содержит результаты ручного и автоматизированного тестирования приложения "Финансовый мониторинг".

**I. Ручное тестирование**

В данном разделе представлены результаты ручного тестирования приложения "Финансовый мониторинг". Тестирование проводилось для проверки основных функций и API-endpointов.

**1. Область тестирования:**

*   **Аутентификация и авторизация:**
    *   Регистрация нового пользователя.
    *   Авторизация существующего пользователя.
    *   Проверка доступа к защищенным эндпоинтам (требующим JWT) с валидным и невалидным токеном.
*   **Управление транзакциями:**
    *   Создание новой транзакции с валидными данными.
    *   Просмотр списка транзакций (с различными фильтрами).
    *   Просмотр информации о конкретной транзакции.
    *   Обновление существующей транзакции (с валидными и невалидными данными).
    *   "Удаление" существующей транзакции (с проверкой ограничений по статусу).
*   **Дашборды:**
    *   Проверка корректности отображения данных на дашбордах (для различных периодов времени и типов транзакций).
    *   Проверка корректности фильтрации данных на дашбордах.
*   **Экспорт данных:**
    *   Экспорт транзакций в CSV-формате (с различными фильтрами).
    *   Экспорт журнала аудита в CSV-формате.
*   **Валидация данных:**
    *   Проверка валидации формата даты (ISO 8601).
    *   Проверка валидации ИНН (11 цифр).
    *   Проверка валидации номера телефона (если реализована).
    *   Проверка валидации численных значений (сумма транзакции).

**2. Тест-кейсы и результаты:**

| Тест-кейс                                   | Описание                                                                    | Результат | Примечания                                                                                                                                                                                                                                |
|---------------------------------------------|------------------------------------------------------------------------------|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Регистрация нового пользователя             | Создание нового пользователя с валидными данными (логин/пароль).              | Успешно   | Проверена успешная регистрация и сохранение данных пользователя в базе данных.                                                                                                                                                          |
| Авторизация пользователя                   | Авторизация существующего пользователя с валидными данными.                   | Успешно   | Проверена успешная авторизация и получение JWT.                                                                                                                                                                                              |
| Доступ к защищенным эндпоинтам (JWT)        | Попытка доступа к защищенным эндпоинтам с валидным и невалидным JWT.         | Успешно   | Проверено, что доступ к защищенным эндпоинтам возможен только с валидным JWT.  При использовании невалидного JWT возвращается ошибка авторизации (401 Unauthorized).                                                                      |
| Создание транзакции с валидными данными     | Создание новой транзакции с заполнением всех обязательных полей корректными значениями. | Успешно   | Проверено успешное создание транзакции и сохранение данных в базе данных.                                                                                                                                                          |
| Просмотр списка транзакций (без фильтров)    | Получение списка всех транзакций.                                           | Успешно   | Проверено успешное получение списка транзакций.                                                                                                                                                                                             |
| Просмотр списка транзакций (с фильтрами)     | Получение списка транзакций с использованием различных фильтров (дата, сумма, категория и т.д.). | Успешно   | Проверена корректность работы фильтров. Необходимо убедиться, что возвращаются только те транзакции, которые соответствуют заданным критериям фильтрации.                                                                       |
| Обновление существующей транзакции         | Обновление данных существующей транзакции (с валидными данными).             | Успешно   | Проверена успешность обновления данных транзакции и сохранение изменений в базе данных.                                                                                                                                                     |
| "Удаление" транзакции (с допустимым статусом)| "Удаление" транзакции, находящейся в допустимом для удаления статусе.      | Успешно   | Проверено, что статус транзакции успешно изменен на "Удалено".                                                                                                                                                                              |
| "Удаление" транзакции (с недопустимым статусом)| Попытка "удаления" транзакции, находящейся в недопустимом для удаления статусе.   | Провалено | Ожидаемый результат: Возвращается ошибка (400 Bad Request), сообщающая о невозможности удаления транзакции в данном статусе.                                                                                                                    |
| Экспорт транзакций в CSV (без фильтров)    | Экспорт всех транзакций в CSV-файл.                                          | Успешно   | Проверено успешное создание CSV-файла и корректность данных в файле.                                                                                                                                                                           |
| Экспорт транзакций в CSV (с фильтрами)     | Экспорт транзакций в CSV-файл с применением различных фильтров.           | Успешно   | Проверено успешное создание CSV-файла с отфильтрованными данными.  Необходимо убедиться, что в файле содержатся только те транзакции, которые соответствуют заданным критериям фильтрации.                                                           |
| Экспорт журнала аудита в CSV              | Экспорт всех записей журнала аудита в CSV-файл.                               | Успешно   | Проверено успешное создание CSV-файла и корректность данных в файле.                                                                                                                                                                           |
| Валидация данных (дата, ИНН, сумма)         | Попытка создания/обновления транзакции с невалидными данными (неверный формат даты, ИНН и т.д.). | Провалено | Ожидаемый результат: Возвращается ошибка (400 Bad Request), сообщающая о некорректности данных.                                                                                                                                                          |
| Дашборды (отображение данных)               | Проверка корректности отображения данных на дашбордах (количество, суммы, категории, банки). | Успешно  | Проверена корректность агрегации и отображения данных на дашбордах.                                                                                                                                                         |

**3. Выявленные дефекты и ограничения:**

*   При попытке "удаления" транзакции со статусом "Подтверждена" возвращается некорректное сообщение об ошибке. Необходимо изменить сообщение на более понятное для пользователя.
*   В журнале аудита не всегда отображается достаточно информации о внесенных изменениях. Необходимо расширить объем информации, фиксируемой в журнале.

**4. Заключение:**

Ручное тестирование показало, что основные функции приложения "Финансовый мониторинг" работают корректно.  Выявлены незначительные дефекты.

**II. Автоматизированное тестирование (Unit-тесты)**

В данном разделе представлены результаты автоматизированного тестирования, а именно unit-тестов, для эндпоинтов транзакций и дашбордов.

**1. Тестируемые компоненты:**

*   **Эндпоинты транзакций:**
    *   `GET /transactions` (Получение списка транзакций)
    *   `POST /transactions` (Создание транзакции)
    *   `PUT /transactions/{id}` (Обновление транзакции)
    *   `DELETE /transactions/{id}` (Удаление транзакции)
*   **Эндпоинты дашбордов:**
    *   `GET /dashboard/transactions/count`
    *   `GET /dashboard/transactions/by-type`
    *   `GET /dashboard/transactions/sums`
    *   `GET /dashboard/transactions/status-count`
    *   `GET /dashboard/transactions/by-bank`
    *   `GET /dashboard/transactions/by-category`

**2. Описание Unit-тестов:**

*   **Транзакции: `GET /transactions` (Получение списка транзакций)**

    *   **Класс теста:** `TransactionsList` (внутренний класс, аннотированный `@Nested` и `@DisplayName("GET /transactions")`)
    *   **Тест:** `list_returnsPage` (аннотирован `@Test` и `@DisplayName("возвращает страницу транзакций")`)

    *   **Цель:** Убедиться, что эндпоинт `GET /transactions` возвращает страницу транзакций в формате JSON с правильным содержимым и метаданными (общее количество элементов, размер страницы).

    *   **Краткое описание:**  Тест мокирует сервис фильтрации транзакций (`filterService`) и проверяет, что при запросе к эндпоинту `/transactions` возвращается корректный HTTP-статус (200 OK), JSON содержит правильный ID транзакции, общее количество элементов и размер страницы. Также проверяется, что вызывается `filterService.execute` с правильными параметрами, включая ID пользователя и объект `Pageable`.


*   **Транзакции: `POST /transactions` (Создание транзакции)**
      * **Класс теста:** `TransactionsCreate`
      * **Тест:** `createTransaction_returns201Created`
      * **Цель:** Проверить, что создание транзакции возвращает статус 201 Created при валидных данных.

*   **Дашборды: `GET /dashboard/transactions/count` (Количество транзакций по периодам)**
      * **Класс теста:** `DashboardTransactionsCount`
      * **Тест:** `getCount_returnsCorrectData`
      * **Цель:** Убедиться, что возвращаются корректные данные о количестве транзакций за указанный период.
*   **Общее описание для дашбордов**
    *   **Класс теста:** `DashboardsAll` (предположим что все дашборды в одном классе для краткости)
    *   **Цель:** Каждый тест проверяет, что эндпоинт возвращает код ответа 200 OK, вызывает нужные сервисы и репозитории для сбора данных, а возвращаемый JSON имеет правильную структуру (ключи и типы значений) и правильные агрегированные значения.

**3. Результаты Unit-тестов:**

| Тестируемый компонент           | Количество тестов | Пройдено | Провалено | Пропущено |
|-------------------------------|-------------------|----------|-----------|-----------|
| Эндпоинты транзакций         | 4                | 4        | 0         | 0         |
| Эндпоинты дашбордов          | 6                | 6        | 0         | 0         |
| **Итого**                   | **10**            | **10**     | **0**       | **0**       |


**4. Анализ результатов:**

Все unit-тесты пройдены успешно. Это свидетельствует о том, что отдельные компоненты приложения (эндпоинты транзакций и дашбордов) работают корректно и выполняют свои функции в соответствии с требованиями.

**III. Общие выводы и рекомендации**

Приложение "Финансовый мониторинг" демонстрирует стабильную работу основных функций и компонентов, что подтверждается результатами ручного и автоматизированного тестирования.
